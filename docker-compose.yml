  version: '3'
  services:
    homeassistant:
      container_name: home-assistant
      image: homeassistant/home-assistant:latest
      volumes:
        - /home/steve/repos/home-assistant:/config
        - /etc/localtime:/etc/localtime:ro
      restart: always
      network_mode: host
      healthcheck:
        test: ["CMD", "curl", "-f", "http://localhost:8123"]
        interval: 1m30s
        timeout: 10s
        retries: 3        
      logging:
        driver: "json-file"
        options:
            max-size: "100k"
            max-file: "20"
    autoheal:
      restart: always
      image: willfarrell/autoheal
      environment:
        - AUTOHEAL_CONTAINER_LABEL=all
      volumes:
        - /var/run/docker.sock:/var/run/docker.sock
